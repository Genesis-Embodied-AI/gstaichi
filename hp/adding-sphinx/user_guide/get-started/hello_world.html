
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Hello, World! &#8212; Taichi 1.8.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=b51e6972"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user_guide/get-started/hello_world';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Accelerate Python with Taichi" href="accelerate_python.html" />
    <link rel="prev" title="User guide" href="../index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="1.8.0" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Taichi 1.8.0 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../autoapi/index.html">
    API Reference
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../autoapi/index.html">
    API Reference
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Hello, World!</a></li>
<li class="toctree-l1"><a class="reference internal" href="accelerate_python.html">Accelerate Python with Taichi</a></li>
<li class="toctree-l1"><a class="reference internal" href="accelerate_pytorch.html">Accelerate PyTorch with Taichi</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Basic</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../basic/field.html">Fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic/ndarray.html">Taichi Ndarray</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic/layout.html">Fields (advanced)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic/offset.html">Coordinate Offsets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic/external.html">Interacting with External Arrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic/sparse.html">Spatially Sparse Data Structures</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Kernels</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../kernels/kernel_function.html">Kernels and Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kernels/kernel_sync.html">Synchronization between Kernels and Python Scope</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Math</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../math/linear_solver.html">Linear Solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/math_module.html">Math Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/sparse_matrix.html">Sparse Matrix</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Performance Tuning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../performance_tuning/performance.html">Performance Tuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../performance_tuning/profiler.html">Profiler</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Advanced</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../advanced/data_oriented_class.html">Data-Oriented Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/dataclass.html">Taichi Dataclass</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/meta.html">Metaprogramming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/quant.html">Use quantized data types</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Differentiable</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../differentiable/differentiable_programming.html">Differentiable Programming</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Type System</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../type_system/type.html">Type System</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../reference/global_settings.html">Global Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/language_reference.html">Language Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/operator.html">Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/simt.html">SIMT Intrinsics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/syntax_sugars.html">Syntax Sugars</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Internals</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../internals/compilation.html">Life of a Taichi Kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../internals/internal.html">Internal Designs</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">glossary</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../glossary/glossary.html">Glossary</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">FAQs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../faqs/faq.html">Frequently Asked Questions</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">User guide</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Hello, World!</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="hello-world">
<h1>Hello, World!<a class="headerlink" href="#hello-world" title="Link to this heading">#</a></h1>
<p>Taichi is a domain-specific language designed for high-performance, parallel computing, and is embedded in Python.</p>
<p>When writing compute-intensive tasks, users can leverage Taichi’s high performance computation by following a set of extra rules, and making use of the two decorators <code class="docutils literal notranslate"><span class="pre">&#64;ti.func</span></code> and <code class="docutils literal notranslate"><span class="pre">&#64;ti.kernel</span></code>. These decorators instruct Taichi to take over the computation tasks and compile the decorated functions to machine code using its just-in-time (JIT) compiler. As a result, calls to these functions are executed on multi-core CPUs or GPUs and can achieve acceleration by 50x~100x compared to native Python code.</p>
<section id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Python: 3.7/3.8/3.9/3.10 (64-bit)</p></li>
<li><p>OS: Windows, OS X, and Linux (64-bit)</p></li>
</ul>
</section>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link to this heading">#</a></h2>
<p>Taichi is available as a PyPI package:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>taichi
</pre></div>
</div>
<div class="note docutils">
<p>If you are <em>not</em> using an IDE for running code, you can simply run the code from your terminal by:</p>
<ol class="arabic simple">
<li><p>Go to the directory that contains your .py file</p></li>
<li><p>Type in <code class="docutils literal notranslate"><span class="pre">python3</span> <span class="pre">filename.py</span></code> (replace <em>filename</em> with your script’s name. Be sure to include the <code class="docutils literal notranslate"><span class="pre">.py</span></code> extension)</p></li>
</ol>
</div>
<p>Let’s dive into this simple Taichi program.</p>
<section id="import-taichi">
<h3>Import Taichi<a class="headerlink" href="#import-taichi" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">taichi</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ti</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">taichi.math</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tm</span>
</pre></div>
</div>
<p>The first two lines import Taichi and its <code class="docutils literal notranslate"><span class="pre">math</span></code> module. The <code class="docutils literal notranslate"><span class="pre">math</span></code> module contains built-in vectors and matrices of small dimensions, such as <code class="docutils literal notranslate"><span class="pre">vec2</span></code> for 2D real vectors and <code class="docutils literal notranslate"><span class="pre">mat3</span></code> for 3×3 real matrices. See the <a class="reference internal" href="../math/math_module.html"><span class="std std-doc">Math Module</span></a> for more information.</p>
</section>
<section id="initialize-taichi">
<h3>Initialize Taichi<a class="headerlink" href="#initialize-taichi" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ti</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">arch</span><span class="o">=</span><span class="n">ti</span><span class="o">.</span><span class="n">gpu</span><span class="p">)</span>
</pre></div>
</div>
<p>The argument <code class="docutils literal notranslate"><span class="pre">arch</span></code> in <code class="docutils literal notranslate"><span class="pre">ti.init()</span></code> specifies the backend that will execute the compiled code. This backend can be either <code class="docutils literal notranslate"><span class="pre">ti.cpu</span></code> or <code class="docutils literal notranslate"><span class="pre">ti.gpu</span></code>. If the <code class="docutils literal notranslate"><span class="pre">ti.gpu</span></code> option is specified, Taichi will attempt to use the GPU backends in the following order: <code class="docutils literal notranslate"><span class="pre">ti.cuda</span></code>, <code class="docutils literal notranslate"><span class="pre">ti.vulkan</span></code>, and <code class="docutils literal notranslate"><span class="pre">ti.opengl/ti.Metal</span></code>. If no GPU architecture is available, the CPU will be used as the backend.</p>
<p>Additionally, you can specify the desired GPU backend directly by setting <code class="docutils literal notranslate"><span class="pre">arch=ti.cuda</span></code>, for example. Taichi will raise an error if the specified architecture is not available. For further information, refer to the <a class="reference internal" href="../reference/global_settings.html"><span class="std std-doc">Global Settings</span></a> section in the Taichi documentation.</p>
<div class="note docutils">
<p><code class="docutils literal notranslate"><span class="pre">ti.init(**kwargs)</span></code>- Initializes Taichi environment and allows you to customize your Taichi runtime depending on the optional arguments passed into it.</p>
</div>
</section>
<section id="define-a-taichi-field">
<h3>Define a Taichi field<a class="headerlink" href="#define-a-taichi-field" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">320</span>
<span class="n">pixels</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
</pre></div>
</div>
<p>The function <code class="docutils literal notranslate"><span class="pre">ti.field(dtype,</span> <span class="pre">shape)</span></code> defines a Taichi field whose shape is of <code class="docutils literal notranslate"><span class="pre">shape</span></code> and whose elements are of type <code class="docutils literal notranslate"><span class="pre">dtype</span></code>.</p>
<p>Field is a fundamental and frequently utilized data structure in Taichi. It can be considered equivalent to NumPy’s <code class="docutils literal notranslate"><span class="pre">ndarray</span></code> or PyTorch’s <code class="docutils literal notranslate"><span class="pre">tensor</span></code>, but with added flexibility. For instance, a Taichi field can be <a class="reference internal" href="../basic/sparse.html"><span class="std std-doc">spatially sparse</span></a> and can be easily <a class="reference internal" href="../basic/layout.html"><span class="std std-doc">changed between different data layouts</span></a>. Further advanced features of fields will be covered in other scenario-based tutorials. For now, it is sufficient to understand that the field <code class="docutils literal notranslate"><span class="pre">pixels</span></code> is a dense two-dimensional array.</p>
</section>
<section id="kernels-and-functions">
<h3>Kernels and functions<a class="headerlink" href="#kernels-and-functions" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@ti</span><span class="o">.</span><span class="n">func</span>
<span class="k">def</span><span class="w"> </span><span class="nf">complex_sqr</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>  <span class="c1"># complex square of a 2D vector</span>
    <span class="k">return</span> <span class="n">tm</span><span class="o">.</span><span class="n">vec2</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="nd">@ti</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">paint</span><span class="p">(</span><span class="n">t</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">pixels</span><span class="p">:</span>  <span class="c1"># Parallelized over all pixels</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">tm</span><span class="o">.</span><span class="n">vec2</span><span class="p">(</span><span class="o">-</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">tm</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.2</span><span class="p">)</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">tm</span><span class="o">.</span><span class="n">vec2</span><span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span> <span class="o">/</span> <span class="n">n</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>
        <span class="n">iterations</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">z</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">20</span> <span class="ow">and</span> <span class="n">iterations</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">:</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">complex_sqr</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="n">c</span>
            <span class="n">iterations</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">pixels</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">iterations</span> <span class="o">*</span> <span class="mf">0.02</span>
</pre></div>
</div>
<p>The code above defines two functions, one decorated with <code class="docutils literal notranslate"><span class="pre">&#64;ti.func</span></code> and the other with <code class="docutils literal notranslate"><span class="pre">&#64;ti.kernel</span></code>. They are called <em>Taichi function</em> and <em>kernel</em> respectively. Taichi functions and kernels are not executed by Python’s interpreter but taken over by Taichi’s JIT compiler and deployed to your parallel multi-core CPU or GPU, which is determined by the <code class="docutils literal notranslate"><span class="pre">arch</span></code> argument in the <code class="docutils literal notranslate"><span class="pre">ti.init()</span></code> call.</p>
<p>The main differences between Taichi functions and kernels are as follows:</p>
<ul class="simple">
<li><p>Kernels serve as the entry points for Taichi to take over the execution. They can be called anywhere in the program, whereas Taichi functions can only be invoked within kernels or other Taichi functions. For instance, in the provided code example, the Taichi function <code class="docutils literal notranslate"><span class="pre">complex_sqr</span></code> is called within the kernel <code class="docutils literal notranslate"><span class="pre">paint</span></code>.</p></li>
<li><p>It is important to note that the arguments and return values of kernels must be type hinted, while Taichi functions do not require type hinting. In the example, the argument <code class="docutils literal notranslate"><span class="pre">t</span></code> in the kernel <code class="docutils literal notranslate"><span class="pre">paint</span></code> is type hinted, while the argument <code class="docutils literal notranslate"><span class="pre">z</span></code> in the Taichi function <code class="docutils literal notranslate"><span class="pre">complex_sqr</span></code> is not.</p></li>
<li><p>Taichi supports the use of nested functions, but nested kernels are not supported. Additionally, Taichi does not support recursive calls within Taichi functions.</p></li>
</ul>
<div class="tip docutils">
<p>Note that, for users familiar with CUDA programming, the <code class="docutils literal notranslate"><span class="pre">ti.func</span></code> in Taichi is equivalent to the <code class="docutils literal notranslate"><span class="pre">__device__</span></code> in CUDA, while the <code class="docutils literal notranslate"><span class="pre">ti.kernel</span></code> in Taichi corresponds to the <code class="docutils literal notranslate"><span class="pre">__global__</span></code> in CUDA.</p>
<p>For those familiar with the world of OpenGL, <code class="docutils literal notranslate"><span class="pre">ti.func</span></code> can be compared to a typical function in GLSL, while <code class="docutils literal notranslate"><span class="pre">ti.kernel</span></code> can be compared to a compute shader.</p>
</div>
</section>
<section id="parallel-for-loops">
<h3>Parallel for loops<a class="headerlink" href="#parallel-for-loops" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@ti</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">paint</span><span class="p">(</span><span class="n">t</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">pixels</span><span class="p">:</span>  <span class="c1"># Parallelized over all pixels</span>
</pre></div>
</div>
<p>The key to achieving high performance in Taichi lies in efficient iteration. By utilizing parallelized looping, data can be processed more effectively.</p>
<p>The code snippet above showcases a for loop at the outermost scope within a Taichi kernel, which is automatically parallelized. The for loop operates on the <code class="docutils literal notranslate"><span class="pre">i</span></code> and <code class="docutils literal notranslate"><span class="pre">j</span></code> indices simultaneously, allowing for concurrent execution of iterations.</p>
<p>Taichi provides a convenient syntax for parallelizing tasks. Any for loop at the outermost scope within a kernel is automatically parallelized, eliminating the need for manual thread allocation, recycling, and memory management.</p>
<p>The field pixels is treated as an iterator, with <code class="docutils literal notranslate"><span class="pre">i</span></code> and <code class="docutils literal notranslate"><span class="pre">j</span></code> being integer indices ranging from <code class="docutils literal notranslate"><span class="pre">0</span></code> to <code class="docutils literal notranslate"><span class="pre">2*n-1</span></code> and <code class="docutils literal notranslate"><span class="pre">0</span></code> to <code class="docutils literal notranslate"><span class="pre">n-1</span></code>, respectively. The <code class="docutils literal notranslate"><span class="pre">(i,</span> <span class="pre">j)</span></code> pairs loop over the sets <code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">0)</span></code>, <code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">1)</span></code>, …, <code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">n-1)</span></code>, <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">0)</span></code>, <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">1)</span></code>, …, <code class="docutils literal notranslate"><span class="pre">(2*n-1,</span> <span class="pre">n-1)</span></code> in parallel.</p>
<p>It is important to keep in mind that for loops nested within other constructs, such as <code class="docutils literal notranslate"><span class="pre">if/else</span></code> statements or other loops, are not automatically parallelized and are processed <em>sequentially</em>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@ti</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">fill</span><span class="p">():</span>
    <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span> <span class="c1"># Parallelized</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span> <span class="c1"># Serialized in each parallel thread</span>
            <span class="n">total</span> <span class="o">+=</span> <span class="n">i</span> <span class="o">*</span> <span class="n">j</span>

    <span class="k">if</span> <span class="n">total</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>  <span class="c1"># Not parallelized because it is not at the outermost scope</span>
</pre></div>
</div>
<p>You may also serialize a for loop at the outermost scope using <code class="docutils literal notranslate"><span class="pre">ti.loop_config(serialize=True)</span></code>. Please refer to <a class="reference internal" href="../debug/debugging.html#serialize-a-specified-parallel-for-loop"><span class="std std-ref">Serialize a specified parallel for loop</span></a> for additional information.</p>
<div class="caution docutils">
<p>The <code class="docutils literal notranslate"><span class="pre">break</span></code> statement is <em>not</em> supported in parallelized loops:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@ti</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">foo</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
        <span class="o">...</span>
        <span class="k">break</span> <span class="c1"># Error!</span>

<span class="nd">@ti</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">foo</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
            <span class="o">...</span>
            <span class="k">break</span> <span class="c1"># OK!</span>
</pre></div>
</div>
</div>
</section>
<section id="key-takeaways">
<h3>Key takeaways<a class="headerlink" href="#key-takeaways" title="Link to this heading">#</a></h3>
<p>Congratulations! By following the brief example above, you have learned the most important features of Taichi:</p>
<ul class="simple">
<li><p>Taichi compiles and executes Taichi functions and kernels on the designated backend.</p></li>
<li><p>For loops located at the outermost scope in a Taichi kernel are automatically parallelized.</p></li>
<li><p>Taichi offers a flexible data container, known as <em>field</em>, and you can utilize indices to iterate over a field.</p></li>
</ul>
</section>
</section>
<section id="supported-systems-and-backends">
<h2>Supported systems and backends<a class="headerlink" href="#supported-systems-and-backends" title="Link to this heading">#</a></h2>
<p>The table below provides an overview of the operating systems supported by Taichi and the corresponding backends that are compatible with these platforms:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p><strong>platform</strong></p></th>
<th class="head text-center"><p><strong>CPU</strong></p></th>
<th class="head text-center"><p><strong>CUDA</strong></p></th>
<th class="head text-center"><p><strong>OpenGL</strong></p></th>
<th class="head text-center"><p><strong>Metal</strong></p></th>
<th class="head text-center"><p><strong>Vulkan</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>Windows</p></td>
<td class="text-center"><p>:heavy_check_mark:</p></td>
<td class="text-center"><p>:heavy_check_mark:</p></td>
<td class="text-center"><p>:heavy_check_mark:</p></td>
<td class="text-center"><p>N/A</p></td>
<td class="text-center"><p>:heavy_check_mark:</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Linux</p></td>
<td class="text-center"><p>:heavy_check_mark:</p></td>
<td class="text-center"><p>:heavy_check_mark:</p></td>
<td class="text-center"><p>:heavy_check_mark:</p></td>
<td class="text-center"><p>N/A</p></td>
<td class="text-center"><p>:heavy_check_mark:</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>macOS</p></td>
<td class="text-center"><p>:heavy_check_mark:</p></td>
<td class="text-center"><p>N/A</p></td>
<td class="text-center"><p>N/A</p></td>
<td class="text-center"><p>:heavy_check_mark:</p></td>
<td class="text-center"><p>:heavy_check_mark:</p></td>
</tr>
</tbody>
</table>
</div>
<ul class="simple">
<li><p>:heavy_check_mark:: supported;</p></li>
<li><p>N/A: not available</p></li>
</ul>
<p>You are now prepared to begin writing your own Taichi programs. The following documents provide more information about how to utilize Taichi in some of its typical application scenarios:</p>
<ul class="simple">
<li><p><a class="reference internal" href="accelerate_python.html"><span class="std std-doc">Accelerate Python with Taichi</span></a></p></li>
<li><p><a class="reference internal" href="accelerate_pytorch.html"><span class="std std-doc">Accelerate PyTorch with Taichi</span></a>.</p></li>
</ul>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">User guide</p>
      </div>
    </a>
    <a class="right-next"
       href="accelerate_python.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Accelerate Python with Taichi</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prerequisites">Prerequisites</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#installation">Installation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import-taichi">Import Taichi</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#initialize-taichi">Initialize Taichi</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-a-taichi-field">Define a Taichi field</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#kernels-and-functions">Kernels and functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parallel-for-loops">Parallel for loops</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-takeaways">Key takeaways</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#supported-systems-and-backends">Supported systems and backends</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/user_guide/get-started/hello_world.md.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2023 Taichi Graphics Inc; 2025 Genesis AI Inc.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>