
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Internal Designs &#8212; Taichi 1.8.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=b51e6972"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user_guide/internals/internal';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Glossary" href="../glossary/glossary.html" />
    <link rel="prev" title="Life of a Taichi Kernel" href="compilation.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="1.8.0" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Taichi 1.8.0 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../autoapi/index.html">
    API Reference
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../autoapi/index.html">
    API Reference
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../get-started/hello_world.html">Hello, World!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get-started/accelerate_python.html">Accelerate Python with Taichi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get-started/accelerate_pytorch.html">Accelerate PyTorch with Taichi</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Basic</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../basic/field.html">Fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic/ndarray.html">Taichi Ndarray</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic/layout.html">Fields (advanced)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic/offset.html">Coordinate Offsets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic/external.html">Interacting with External Arrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic/sparse.html">Spatially Sparse Data Structures</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Kernels</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../kernels/kernel_function.html">Kernels and Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kernels/kernel_sync.html">Synchronization between Kernels and Python Scope</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Math</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../math/linear_solver.html">Linear Solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/math_module.html">Math Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/sparse_matrix.html">Sparse Matrix</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Performance Tuning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../performance_tuning/performance.html">Performance Tuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../performance_tuning/profiler.html">Profiler</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Advanced</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../advanced/data_oriented_class.html">Data-Oriented Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/dataclass.html">Taichi Dataclass</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/meta.html">Metaprogramming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/quant.html">Use quantized data types</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Differentiable</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../differentiable/differentiable_programming.html">Differentiable Programming</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Type System</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../type_system/type.html">Type System</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../reference/global_settings.html">Global Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/language_reference.html">Language Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/operator.html">Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/simt.html">SIMT Intrinsics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/syntax_sugars.html">Syntax Sugars</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Internals</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="compilation.html">Life of a Taichi Kernel</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Internal Designs</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">glossary</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../glossary/glossary.html">Glossary</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">FAQs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../faqs/faq.html">Frequently Asked Questions</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">User guide</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Internal Designs</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="internal-designs">
<h1>Internal Designs<a class="headerlink" href="#internal-designs" title="Link to this heading">#</a></h1>
<section id="intermediate-representation-ir">
<h2>Intermediate representation (IR)<a class="headerlink" href="#intermediate-representation-ir" title="Link to this heading">#</a></h2>
<p>Taichi’s computation IR is designed to be</p>
<ul class="simple">
<li><p>Static-single assignment;</p></li>
<li><p>Hierarchical, instead of LLVM-style control-flow graph + basic blocks;</p></li>
<li><p>Differentiable;</p></li>
<li><p>Statically and strongly typed.</p></li>
</ul>
<p>For example, a simple Taichi kernel</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">taichi</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ti</span>
<span class="n">ti</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">print_ir</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nd">@ti</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">foo</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="n">foo</span><span class="p">()</span>
</pre></div>
</div>
<p>may be compiled into</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>kernel {
  $0 = offloaded range_for(0, 10) grid_dim=0 block_dim=32
  body {
    &lt;i32&gt; $1 = loop $0 index 0
    &lt;i32&gt; $2 = const [4]
    &lt;i32&gt; $3 = cmp_lt $1 $2
    &lt;i32&gt; $4 = const [1]
    &lt;i32&gt; $5 = bit_and $3 $4
    $6 : if $5 {
      print $1, &quot;\n&quot;
    }
  }
}

</pre></div>
</div>
<div class="note docutils">
<p>Use <code class="docutils literal notranslate"><span class="pre">ti.init(print_ir=True)</span></code> to print IR of all instantiated kernels.</p>
</div>
<div class="note docutils">
<p>See <a class="reference internal" href="compilation.html"><span class="std std-doc">Life of a Taichi kernel</span></a> for more details about
the JIT compilation system of Taichi.</p>
</div>
</section>
<section id="data-structure-organization">
<h2>Data structure organization<a class="headerlink" href="#data-structure-organization" title="Link to this heading">#</a></h2>
<p>The internal organization of Taichi’s data structure is defined using the <strong>Structural Node</strong>
(“SNode”, /snōd/) tree system. The SNode system might be confusing for new developers:
it is important to distinguish three concepts: SNode <strong>containers</strong>,
SNode <strong>cells</strong>, and SNode <strong>components</strong>.</p>
<ul class="simple">
<li><p>A SNode <strong>container</strong> can have multiple SNode <strong>cells</strong>. The numbers of
<strong>cells</strong> are recommended to be powers of two.</p>
<ul>
<li><p>For example, <code class="docutils literal notranslate"><span class="pre">S</span> <span class="pre">=</span> <span class="pre">ti.root.dense(ti.i,</span> <span class="pre">128)</span></code> creates an SNode <code class="docutils literal notranslate"><span class="pre">S</span></code>, and each <code class="docutils literal notranslate"><span class="pre">S</span></code> container has <code class="docutils literal notranslate"><span class="pre">128</span></code> <code class="docutils literal notranslate"><span class="pre">S</span></code> cells.</p></li>
</ul>
</li>
<li><p>A SNode <strong>cell</strong> can have multiple SNode <strong>components</strong>.</p>
<ul>
<li><p>For example, <code class="docutils literal notranslate"><span class="pre">P</span> <span class="pre">=</span> <span class="pre">S.dense(ti.i,</span> <span class="pre">4);</span> <span class="pre">Q</span> <span class="pre">=</span> <span class="pre">S.dense(ti.i,</span> <span class="pre">4)</span></code> inserts two components (one <code class="docutils literal notranslate"><span class="pre">P</span></code> container and one <code class="docutils literal notranslate"><span class="pre">Q</span></code> container) into each <code class="docutils literal notranslate"><span class="pre">S</span></code> cell.</p></li>
</ul>
</li>
<li><p>Note that each SNode <strong>component</strong> is a SNode <strong>container</strong> of a lower-level SNode.</p></li>
</ul>
<p>A hierarchical data structure in Taichi, dense or sparse, is essentially a tree with interleaved container and cell levels.
Note that containers of <code class="docutils literal notranslate"><span class="pre">place</span></code> SNodes do not have cells. Instead, they
directly contain numerical values.</p>
<p>Consider the following example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># misc/listgen_demo.py</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">i32</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">i32</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">i32</span><span class="p">)</span>

<span class="n">S0</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">root</span>
<span class="n">S1</span> <span class="o">=</span> <span class="n">S0</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">i</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="n">S2</span> <span class="o">=</span> <span class="n">S1</span><span class="o">.</span><span class="n">dense</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">S2</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="c1"># S3: x; S4: y</span>

<span class="n">S5</span> <span class="o">=</span> <span class="n">S1</span><span class="o">.</span><span class="n">dense</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">S5</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="c1"># S6: z</span>
</pre></div>
</div>
<ul class="simple">
<li><p>The whole data structure is an <code class="docutils literal notranslate"><span class="pre">S0root</span></code> <strong>container</strong>, containing</p>
<ul>
<li><p>1x <code class="docutils literal notranslate"><span class="pre">S0root</span></code> <strong>cell</strong>, which has only one <strong>component</strong>, which
is</p>
<ul>
<li><p>An <code class="docutils literal notranslate"><span class="pre">S1pointer</span></code> <strong>container</strong>, containing</p>
<ul>
<li><p>4x <code class="docutils literal notranslate"><span class="pre">S1pointer</span></code> <strong>cells</strong>, each with two <strong>components</strong>,
which are</p>
<ul>
<li><p>An <code class="docutils literal notranslate"><span class="pre">S2dense</span></code> <strong>container</strong>, containing</p>
<ul>
<li><p>2x <code class="docutils literal notranslate"><span class="pre">S2dense</span></code> <strong>cells</strong>, each with two
<strong>components</strong>, which are</p>
<ul>
<li><p>An <code class="docutils literal notranslate"><span class="pre">S3place_x</span></code> container which directly
contains a <code class="docutils literal notranslate"><span class="pre">x:</span> <span class="pre">ti.i32</span></code> value</p></li>
<li><p>An <code class="docutils literal notranslate"><span class="pre">S4place_y</span></code> container which directly
contains a <code class="docutils literal notranslate"><span class="pre">y:</span> <span class="pre">ti.i32</span></code> value</p></li>
</ul>
</li>
</ul>
</li>
<li><p>An <code class="docutils literal notranslate"><span class="pre">S5dense</span></code> <strong>container</strong>, containing</p>
<ul>
<li><p>2x <code class="docutils literal notranslate"><span class="pre">S5dense</span></code> <strong>cells</strong>, each with one
<strong>component</strong>, which is</p>
<ul>
<li><p>An <code class="docutils literal notranslate"><span class="pre">S6place</span></code> container which directly
contains a <code class="docutils literal notranslate"><span class="pre">z:</span> <span class="pre">ti.i32</span></code> value</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>The following figure shows the hierarchy of the data structure. The
numbers are <code class="docutils literal notranslate"><span class="pre">indices</span></code> of the containers and cells.</p>
<p><img alt="image" src="https://raw.githubusercontent.com/taichi-dev/public_files/fa03e63ca4e161318c8aa9a5db7f4a825604df88/taichi/data_structure_organization.png" /></p>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">S0root</span></code> container and cell do not have an <code class="docutils literal notranslate"><span class="pre">index</span></code>.</p>
<p>In summary, we will have the following containers:</p>
<ul class="simple">
<li><p>1x <code class="docutils literal notranslate"><span class="pre">S0root</span></code> container</p></li>
<li><p>1x <code class="docutils literal notranslate"><span class="pre">S1pointer</span></code> container</p></li>
<li><p>4x <code class="docutils literal notranslate"><span class="pre">S2dense</span></code> containers</p></li>
<li><p>4x <code class="docutils literal notranslate"><span class="pre">S5dense</span></code> containers</p></li>
<li><p>8x <code class="docutils literal notranslate"><span class="pre">S3place_x</span></code> containers, each directly containing an <code class="docutils literal notranslate"><span class="pre">i32</span></code> value</p></li>
<li><p>8x <code class="docutils literal notranslate"><span class="pre">S4place_y</span></code> containers, each directly containing an <code class="docutils literal notranslate"><span class="pre">i32</span></code> value</p></li>
<li><p>8x <code class="docutils literal notranslate"><span class="pre">S6place_z</span></code> containers, each directly containing an <code class="docutils literal notranslate"><span class="pre">i32</span></code> value</p></li>
</ul>
<p>… and the following cells:</p>
<ul class="simple">
<li><p>1x <code class="docutils literal notranslate"><span class="pre">S0root</span></code> cell</p></li>
<li><p>4x <code class="docutils literal notranslate"><span class="pre">S1pointer</span></code> cells</p></li>
<li><p>8x <code class="docutils literal notranslate"><span class="pre">S2dense</span></code> cells</p></li>
<li><p>8x <code class="docutils literal notranslate"><span class="pre">S5dense</span></code> cells</p></li>
</ul>
<p>Again, note that <code class="docutils literal notranslate"><span class="pre">S3place_x</span></code>, <code class="docutils literal notranslate"><span class="pre">S4place_y</span></code> and <code class="docutils literal notranslate"><span class="pre">S6place_z</span></code> containers do <strong>not</strong>
have corresponding cells.</p>
<p>In struct compilers of supported backends, each SNode has two types: <code class="docutils literal notranslate"><span class="pre">container</span></code> type and
<code class="docutils literal notranslate"><span class="pre">cell</span></code> type. Again, <strong>components</strong> of a higher level SNode <strong>cell</strong> are
<strong>containers</strong> of a lower level SNode.</p>
<p>Note that <strong>cells</strong> are never exposed to end-users.</p>
<p><strong>List generation</strong> generates lists of SNode <strong>containers</strong> (instead of
SNode <strong>cells</strong>).</p>
<div class="note docutils">
<p>We are on our way to remove usages of <strong>children</strong>, <strong>instances</strong>, and
<strong>elements</strong> in Taichi. These are very ambiguous terms and should be replaced with standardized terms: <strong>container</strong>, <strong>cell</strong>, and <strong>component</strong>.</p>
</div>
</section>
<section id="list-generation">
<h2>List generation<a class="headerlink" href="#list-generation" title="Link to this heading">#</a></h2>
<p>Struct-fors in Taichi loop over all active elements of a (sparse) data
structure <strong>in parallel</strong>. Evenly distributing work onto processor cores
is challenging on sparse data structures: naively splitting an irregular
tree into pieces can easily lead to partitions with drastically
different numbers of leaf elements.</p>
<p>Our strategy is to generate lists of active <strong>SNode containers</strong>, layer by
layer. The list generation computation happens on the same device as
normal computation kernels, depending on the <code class="docutils literal notranslate"><span class="pre">arch</span></code> argument when the
user calls <code class="docutils literal notranslate"><span class="pre">ti.init()</span></code>.</p>
<p>List generations flatten the data structure leaf elements into a 1D
list, circumventing the irregularity of incomplete trees. Then we
can simply invoke a regular <strong>parallel for</strong> over the 1D list.</p>
<p>For example,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># misc/listgen_demo.py</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">taichi</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ti</span>

<span class="n">ti</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">print_ir</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">i32</span><span class="p">)</span>

<span class="n">S0</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">root</span>
<span class="n">S1</span> <span class="o">=</span> <span class="n">S0</span><span class="o">.</span><span class="n">dense</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">i</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">S2</span> <span class="o">=</span> <span class="n">S1</span><span class="o">.</span><span class="n">bitmasked</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">i</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">S2</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="nd">@ti</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">func</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="n">func</span><span class="p">()</span>
</pre></div>
</div>
<p>gives you the following IR:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$0 = offloaded clear_list S1dense
$1 = offloaded listgen S0root-&gt;S1dense
$2 = offloaded clear_list S2bitmasked
$3 = offloaded listgen S1dense-&gt;S2bitmasked
$4 = offloaded struct_for(S2bitmasked) block_dim=0 {
  &lt;i32 x1&gt; $5 = loop index 0
  print i, $5
}
</pre></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">func</span></code> leads to two list generations:</p>
<ul class="simple">
<li><p>(Tasks <code class="docutils literal notranslate"><span class="pre">$0</span></code> and <code class="docutils literal notranslate"><span class="pre">$1</span></code>) based on the list of the (only) <code class="docutils literal notranslate"><span class="pre">S0root</span></code> container,
generate the list of the (only) <code class="docutils literal notranslate"><span class="pre">S1dense</span></code> container;</p></li>
<li><p>(Tasks <code class="docutils literal notranslate"><span class="pre">$2</span></code> and <code class="docutils literal notranslate"><span class="pre">$3</span></code>) based on the list of <code class="docutils literal notranslate"><span class="pre">S1dense</span></code> containers,
generate the list of <code class="docutils literal notranslate"><span class="pre">S2bitmasked</span></code> containers.</p></li>
</ul>
<p>The list of <code class="docutils literal notranslate"><span class="pre">S0root</span></code> SNode always has exactly one container, so we
never clear or re-generate this list. Although the list of <code class="docutils literal notranslate"><span class="pre">S1dense</span></code> always
has only one container, we still regenerate the list for uniformity.
The list of <code class="docutils literal notranslate"><span class="pre">S2bitmasked</span></code> has 4 containers.</p>
<div class="note docutils">
<p>The list of <code class="docutils literal notranslate"><span class="pre">place</span></code> (leaf) nodes (e.g., <code class="docutils literal notranslate"><span class="pre">S3</span></code> in this example) is never
generated. Instead, we simply loop over the list of their parent nodes,
and for each parent node we enumerate the <code class="docutils literal notranslate"><span class="pre">place</span></code> nodes on-the-fly
(without actually generating a list).</p>
<p>The motivation for this design is to amortize list generation overhead.
Generating one list element per leaf node (<code class="docutils literal notranslate"><span class="pre">place</span></code> SNode) element is too
expensive, likely much more expensive than the essential computation
happening on the leaf element. Therefore we only generate their parent
element list, so that the list generation cost is amortized over
multiple child elements of a second-to-last-level SNode element.</p>
<p>In the example above, although we have 16 instances of <code class="docutils literal notranslate"><span class="pre">x</span></code>, we only
generate a list of 4 x <code class="docutils literal notranslate"><span class="pre">S2bitmasked</span></code> nodes (and 1 x <code class="docutils literal notranslate"><span class="pre">S1dense</span></code> node).</p>
</div>
</section>
<section id="statistics">
<h2>Statistics<a class="headerlink" href="#statistics" title="Link to this heading">#</a></h2>
<p>In some cases, it is helpful to gather certain quantitative information
about internal events during Taichi program execution. The <code class="docutils literal notranslate"><span class="pre">Statistics</span></code>
class is designed for this purpose.</p>
<p>Usage:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;taichi/util/statistics.h&quot;</span>

<span class="c1">// add 1.0 to counter &quot;codegen_offloaded_tasks&quot;</span>
<span class="n">taichi</span><span class="o">::</span><span class="n">stat</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;codegen_offloaded_tasks&quot;</span><span class="p">);</span>

<span class="c1">// add the number of statements in &quot;ir&quot; to counter &quot;codegen_statements&quot;</span>
<span class="n">taichi</span><span class="o">::</span><span class="n">stat</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;codegen_statements&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">irpass</span><span class="o">::</span><span class="n">analysis</span><span class="o">::</span><span class="n">count_statements</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">ir</span><span class="p">));</span>
</pre></div>
</div>
<p>Note the keys are <code class="docutils literal notranslate"><span class="pre">std::string</span></code> and values are <code class="docutils literal notranslate"><span class="pre">double</span></code>.</p>
<p>To print out all statistics in Python:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ti</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">print_stat</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="why-python-frontend">
<h2>Why Python frontend<a class="headerlink" href="#why-python-frontend" title="Link to this heading">#</a></h2>
<p>Embedding Taichi in <code class="docutils literal notranslate"><span class="pre">python</span></code> has the following advantages:</p>
<ul class="simple">
<li><p>Easy to learn. Taichi has a very similar syntax to Python.</p></li>
<li><p>Easy to run. No ahead-of-time compilation is needed.</p></li>
<li><p>This design allows people to reuse existing python infrastructure:</p>
<ul>
<li><p>IDEs. A python IDE mostly works for Taichi with syntax
highlighting, syntax checking, and autocomplete.</p></li>
<li><p>Package manager (pip). A developed Taichi application and be
easily submitted to <code class="docutils literal notranslate"><span class="pre">PyPI</span></code> and others can easily set it up with
<code class="docutils literal notranslate"><span class="pre">pip</span></code>.</p></li>
<li><p>Existing packages. Interacting with other python components
(e.g. <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> and <code class="docutils literal notranslate"><span class="pre">numpy</span></code>) is just trivial.</p></li>
</ul>
</li>
<li><p>The built-in AST manipulation tools in <code class="docutils literal notranslate"><span class="pre">python</span></code> allow us to flexibly
manipulate and analyze Python ASTs,
as long as the kernel body function is parse-able by the Python parser.</p></li>
</ul>
<p>However, this design has drawbacks too:</p>
<ul class="simple">
<li><p>Taichi kernels must be parse-able by Python parsers. This means Taichi
syntax cannot go beyond Python syntax.</p>
<ul>
<li><p>For example, indexing is always needed when accessing elements
in Taichi fields, even if the fields is 0D. Use <code class="docutils literal notranslate"><span class="pre">x[None]</span> <span class="pre">=</span> <span class="pre">123</span></code>
to set the value in <code class="docutils literal notranslate"><span class="pre">x</span></code> if <code class="docutils literal notranslate"><span class="pre">x</span></code> is 0D. This is because <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">123</span></code>
will set <code class="docutils literal notranslate"><span class="pre">x</span></code> itself (instead of its containing value) to be the
constant <code class="docutils literal notranslate"><span class="pre">123</span></code> in Python syntax. For code consistency in Python-
and Taichi-scope, we have to use the more verbose <code class="docutils literal notranslate"><span class="pre">x[None]</span> <span class="pre">=</span> <span class="pre">123</span></code> syntax.</p></li>
</ul>
</li>
<li><p>Python has relatively low performance. This can cause a performance
issue when initializing large Taichi fields with pure python
scripts. A Taichi kernel should be used to initialize huge fields.</p></li>
</ul>
</section>
<section id="virtual-indices-v-s-physical-indices">
<h2>Virtual indices v.s. physical indices<a class="headerlink" href="#virtual-indices-v-s-physical-indices" title="Link to this heading">#</a></h2>
<p>In Taichi, <em>virtual indices</em> are used to locate elements in fields, and
<em>physical indices</em> are used to specify data layouts in memory.</p>
<p>For example,</p>
<ul class="simple">
<li><p>In <code class="docutils literal notranslate"><span class="pre">a[i,</span> <span class="pre">j,</span> <span class="pre">k]</span></code>, <code class="docutils literal notranslate"><span class="pre">i</span></code>, <code class="docutils literal notranslate"><span class="pre">j</span></code>, and <code class="docutils literal notranslate"><span class="pre">k</span></code> are <strong>virtual</strong> indices.</p></li>
<li><p>In <code class="docutils literal notranslate"><span class="pre">for</span> <span class="pre">i,</span> <span class="pre">j</span> <span class="pre">in</span> <span class="pre">x:</span></code>, <code class="docutils literal notranslate"><span class="pre">i</span></code> and <code class="docutils literal notranslate"><span class="pre">j</span></code> are <strong>virtual</strong> indices.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ti.i,</span> <span class="pre">ti.j,</span> <span class="pre">ti.k,</span> <span class="pre">ti.l,</span> <span class="pre">...</span></code> are <strong>physical</strong> indices.</p></li>
<li><p>In struct-for statements, <code class="docutils literal notranslate"><span class="pre">LoopIndexStmt::index</span></code> is a <strong>physical</strong>
index.</p></li>
</ul>
<p>The mapping between virtual indices and physical indices for each
<code class="docutils literal notranslate"><span class="pre">SNode</span></code> is stored in <code class="docutils literal notranslate"><span class="pre">SNode::physical_index_position</span></code>. I.e.,
<code class="docutils literal notranslate"><span class="pre">physical_index_position[i]</span></code> answers the question: <strong>which physical
index does the i-th virtual index</strong> correspond to?</p>
<p>Each <code class="docutils literal notranslate"><span class="pre">SNode</span></code> can have a different virtual-to-physical mapping.
<code class="docutils literal notranslate"><span class="pre">physical_index_position[i]</span> <span class="pre">==</span> <span class="pre">-1</span></code> means the <code class="docutils literal notranslate"><span class="pre">i</span></code>-th virtual index does
not correspond to any physical index in this <code class="docutils literal notranslate"><span class="pre">SNode</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">SNode</span></code> s in handy dense fields (i.e.,
<code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">=</span> <span class="pre">ti.field(ti.i32,</span> <span class="pre">shape=(128,</span> <span class="pre">256,</span> <span class="pre">512))</span></code>) have <strong>trivial</strong>
virtual-to-physical mapping, e.g. <code class="docutils literal notranslate"><span class="pre">physical_index_position[i]</span> <span class="pre">=</span> <span class="pre">i</span></code>.</p>
<p>However, more complex data layouts, such as column-major 2D fields can
lead to <code class="docutils literal notranslate"><span class="pre">SNodes</span></code> with <code class="docutils literal notranslate"><span class="pre">physical_index_position[0]</span> <span class="pre">=</span> <span class="pre">1</span></code> and
<code class="docutils literal notranslate"><span class="pre">physical_index_position[1]</span> <span class="pre">=</span> <span class="pre">0</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">f32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">b</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">f32</span><span class="p">)</span>
<span class="n">ti</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">dense</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">j</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span><span class="o">.</span><span class="n">dense</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">i</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

<span class="n">ti</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">impl</span><span class="o">.</span><span class="n">get_runtime</span><span class="p">()</span><span class="o">.</span><span class="n">materialize</span><span class="p">()</span> <span class="c1"># This is an internal api for dev, we don&#39;t make sure it is stable for user.</span>

<span class="n">mapping_a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">snode</span><span class="p">()</span><span class="o">.</span><span class="n">physical_index_position</span><span class="p">()</span>

<span class="k">assert</span> <span class="n">mapping_a</span> <span class="o">==</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>

<span class="n">mapping_b</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">snode</span><span class="p">()</span><span class="o">.</span><span class="n">physical_index_position</span><span class="p">()</span>

<span class="k">assert</span> <span class="n">mapping_b</span> <span class="o">==</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
<span class="c1"># Note that b is column-major:</span>
<span class="c1"># the virtual first index exposed to the user comes second in memory layout.</span>
</pre></div>
</div>
<p>Taichi supports up to 12 (<code class="docutils literal notranslate"><span class="pre">constexpr</span> <span class="pre">int</span> <span class="pre">taichi_max_num_indices</span> <span class="pre">=</span> <span class="pre">12</span></code>)
virtual indices and physical indices.</p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="compilation.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Life of a Taichi Kernel</p>
      </div>
    </a>
    <a class="right-next"
       href="../glossary/glossary.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Glossary</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#intermediate-representation-ir">Intermediate representation (IR)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-structure-organization">Data structure organization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#list-generation">List generation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#statistics">Statistics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-python-frontend">Why Python frontend</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#virtual-indices-v-s-physical-indices">Virtual indices v.s. physical indices</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/user_guide/internals/internal.md.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2023 Taichi Graphics Inc; 2025 Genesis AI Inc.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>