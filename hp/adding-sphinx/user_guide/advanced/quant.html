
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Use quantized data types &#8212; Taichi 1.8.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=b51e6972"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user_guide/advanced/quant';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Differentiable Programming" href="../differentiable/differentiable_programming.html" />
    <link rel="prev" title="Metaprogramming" href="meta.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="1.8.0" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Taichi 1.8.0 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../autoapi/index.html">
    API Reference
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../autoapi/index.html">
    API Reference
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../get-started/hello_world.html">Hello, World!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get-started/accelerate_python.html">Accelerate Python with Taichi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get-started/accelerate_pytorch.html">Accelerate PyTorch with Taichi</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Basic</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../basic/field.html">Fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic/ndarray.html">Taichi Ndarray</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic/layout.html">Fields (advanced)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic/offset.html">Coordinate Offsets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic/external.html">Interacting with External Arrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic/sparse.html">Spatially Sparse Data Structures</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Kernels</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../kernels/kernel_function.html">Kernels and Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kernels/kernel_sync.html">Synchronization between Kernels and Python Scope</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Math</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../math/linear_solver.html">Linear Solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/math_module.html">Math Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/sparse_matrix.html">Sparse Matrix</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Performance Tuning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../performance_tuning/performance.html">Performance Tuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../performance_tuning/profiler.html">Profiler</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Advanced</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="data_oriented_class.html">Data-Oriented Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataclass.html">Taichi Dataclass</a></li>
<li class="toctree-l1"><a class="reference internal" href="meta.html">Metaprogramming</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Use quantized data types</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Differentiable</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../differentiable/differentiable_programming.html">Differentiable Programming</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Type System</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../type_system/type.html">Type System</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../reference/global_settings.html">Global Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/language_reference.html">Language Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/operator.html">Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/simt.html">SIMT Intrinsics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/syntax_sugars.html">Syntax Sugars</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Internals</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../internals/compilation.html">Life of a Taichi Kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../internals/internal.html">Internal Designs</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">glossary</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../glossary/glossary.html">Glossary</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">FAQs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../faqs/faq.html">Frequently Asked Questions</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">User guide</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Use quantized data types</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="use-quantized-data-types">
<h1>Use quantized data types<a class="headerlink" href="#use-quantized-data-types" title="Link to this heading">#</a></h1>
<p>High-resolution simulations can deliver great visual quality, but are often limited by the capacity of the onboard memory, GPU memory in particular.</p>
<p>To help reduce the memory footprint of your programs, Taichi provides quantized data types, aka low-precision data types. It allows you to define your own integers, fixed-point numbers, or floating-point numbers with arbitrary number of bits that work best with your limited memory capacity. At the same time, Taichi provides a suite of tailored optimizations to ensure that the runtime performance with quantized data types is comparable to the performance with full-precision data types.</p>
<div class="note docutils">
<p>For now, quantized data types are supported only on the CPU and CUDA backends.</p>
</div>
<section id="quantized-data-types">
<h2>Quantized data types<a class="headerlink" href="#quantized-data-types" title="Link to this heading">#</a></h2>
<p>Taichi supports the following quantized data types:</p>
<ul class="simple">
<li><p>Quantized integers</p></li>
<li><p>Quantized fixed-point numbers</p></li>
<li><p>Quantized floating-point numbers</p></li>
</ul>
<section id="quantized-integers">
<h3>Quantized integers<a class="headerlink" href="#quantized-integers" title="Link to this heading">#</a></h3>
<p>Quantized integers in Taichi are represented in the <a class="reference external" href="https://en.wikipedia.org/wiki/Two's_complement">two’s complement</a> format but can contain arbitrary number of bits.</p>
<ul class="simple">
<li><p>To define a 10-bit signed integer type:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">i10</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">quant</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="n">bits</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># `signed` is set to `True` by default</span>
</pre></div>
</div>
<ul class="simple">
<li><p>To define a 5-bit unsigned integer type:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">u5</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">quant</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="n">bits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">signed</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="quantized-fixed-point-numbers">
<h3>Quantized fixed-point numbers<a class="headerlink" href="#quantized-fixed-point-numbers" title="Link to this heading">#</a></h3>
<p>The core idea of <a class="reference external" href="https://en.wikipedia.org/wiki/Fixed-point_arithmetic">fixed-point numbers</a> is that, if a specific range is evenly divided into multiple scale units, then a real number within that range can be approximated and represented by multiplying the value of each scale unit by an integer number. Here’s an example explaining what the <em>scale unit</em> here is: If you wish to represent a real number within [0, 100] in 10 binary bits, then each <em>scale unit</em> equals 100/2<sup>10</sup> ≈ 0.098.</p>
<p>Taichi allows you to define quantized fixed-point types of less than 64 bits and with an arbitrary scale unit.</p>
<ul class="simple">
<li><p>To define a 10-bit signed fixed-point type within the range [-20.0, 20.0]:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fixed_type_a</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">quant</span><span class="o">.</span><span class="n">fixed</span><span class="p">(</span><span class="n">bits</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_value</span><span class="o">=</span><span class="mf">20.0</span><span class="p">)</span>  <span class="c1"># `signed` is set to `True` by default</span>
</pre></div>
</div>
<ul class="simple">
<li><p>To define a 5-bit unsigned fixed-point type within the range [0.0, 100.0]:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fixed_type_b</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">quant</span><span class="o">.</span><span class="n">fixed</span><span class="p">(</span><span class="n">bits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">signed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_value</span><span class="o">=</span><span class="mf">100.0</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>To define a 6-bit unsigned fixed-point type within [0.0, 64.0]:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fixed_type_c</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">quant</span><span class="o">.</span><span class="n">fixed</span><span class="p">(</span><span class="n">bits</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">signed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>  <span class="c1"># `scale` is a predefined scaling factor</span>
</pre></div>
</div>
<blockquote>
<div><p>Set either <code class="docutils literal notranslate"><span class="pre">scale</span></code> or <code class="docutils literal notranslate"><span class="pre">max_value</span></code>, and Taichi works out the other based on your setting. Do <em>not</em> set both.
<code class="docutils literal notranslate"><span class="pre">max_value</span></code> is a more commonly used parameter, because you may already know the range of the number to represent.</p>
</div></blockquote>
</section>
<section id="quantized-floating-point-numbers">
<h3>Quantized floating-point numbers<a class="headerlink" href="#quantized-floating-point-numbers" title="Link to this heading">#</a></h3>
<p>A <a class="reference external" href="https://en.wikipedia.org/wiki/Floating-point_arithmetic">floating-point number</a> comprises exponent bits, fraction bits, and a sign bit. There are various floating-point formats:</p>
<p><img alt="image" src="../../_images/floating-point_formats.png" /></p>
<p>Taichi allows you to define a <em>quantized floating-point number</em> with an arbitrary combination of exponent bits and fraction bits (the sign bit is made part of the fraction bits).</p>
<ul class="simple">
<li><p>To define a 15-bit signed floating-point type with five exponent bits:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">float_type_a</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">quant</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">exp</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">frac</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># `signed` is set to `True` by default</span>
</pre></div>
</div>
<ul class="simple">
<li><p>To define a 15-bit unsigned floating-point type with six exponent bits:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">float_type_b</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">quant</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">exp</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">frac</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">signed</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="compute-types">
<h3>Compute types<a class="headerlink" href="#compute-types" title="Link to this heading">#</a></h3>
<p>All the above-mentioned parameters specify how a quantized data type is stored in your computer. However, most quantized data types have no native support on hardware, so an actual value of that quantized data type needs to be converted to a primitive type (”<em>compute type</em>”) during computation.</p>
<ul class="simple">
<li><p>The default compute type for quantized integers is <code class="docutils literal notranslate"><span class="pre">ti.i32</span></code>,</p></li>
<li><p>The default compute type for quantized fixed-point numbers is <code class="docutils literal notranslate"><span class="pre">ti.f32</span></code>,</p></li>
<li><p>The default compute type for quantized floating-point numbers is <code class="docutils literal notranslate"><span class="pre">ti.f32</span></code>.</p></li>
</ul>
<p>To change the compute type of a quantized data type,  set the <code class="docutils literal notranslate"><span class="pre">compute</span></code> parameter when defining the quantized data type:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">i21</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">quant</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="n">bits</span><span class="o">=</span><span class="mi">21</span><span class="p">,</span> <span class="n">compute</span><span class="o">=</span><span class="n">ti</span><span class="o">.</span><span class="n">i64</span><span class="p">)</span>
<span class="n">bfloat16</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">quant</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">exp</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">frac</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">compute</span><span class="o">=</span><span class="n">ti</span><span class="o">.</span><span class="n">f32</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="data-containers-for-quantized-data-types">
<h2>Data containers for quantized data types<a class="headerlink" href="#data-containers-for-quantized-data-types" title="Link to this heading">#</a></h2>
<p>Quantized data types are not primitive types and hence require the following constructs to work with Taichi’s data containers.</p>
<ul class="simple">
<li><p>Bitpacked fields</p></li>
<li><p>Quant arrays</p></li>
</ul>
<section id="bitpacked-fields">
<h3>Bitpacked fields<a class="headerlink" href="#bitpacked-fields" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">ti.BitpackedFields</span></code> packs a group of fields whose <code class="docutils literal notranslate"><span class="pre">dtype</span></code>s are
quantized data types together so that they are stored with one primitive type.
You can then place a <code class="docutils literal notranslate"><span class="pre">ti.BitpackedFields</span></code> instance under any SNode as if each member field
is placed individually.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">float_type_a</span><span class="p">)</span>  <span class="c1"># 15 bits</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">fixed_type_b</span><span class="p">)</span>  <span class="c1"># 5 bits</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">fixed_type_c</span><span class="p">)</span>  <span class="c1"># 6 bits</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">u5</span><span class="p">)</span>  <span class="c1"># 5 bits</span>
<span class="n">bitpack</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">BitpackedFields</span><span class="p">(</span><span class="n">max_num_bits</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<span class="n">bitpack</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>  <span class="c1"># 31 out of 32 bits occupied</span>
<span class="n">ti</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">dense</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">i</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">bitpack</span><span class="p">)</span>
</pre></div>
</div>
<section id="shared-exponent">
<h4>Shared exponent<a class="headerlink" href="#shared-exponent" title="Link to this heading">#</a></h4>
<p>When multiple fields with quantized floating-point types are packed together,
there is chance that they can share a common exponent. For example, in a 3D
velocity vector, if you know the x-component has a much larger absolute value
compared to y- and z-components, then you probably do not care about the exact
value of the y- and z-components. In this case, using a shared exponent can
leave more bits for components with larger absolute values. You can use
<code class="docutils literal notranslate"><span class="pre">place(x,</span> <span class="pre">y,</span> <span class="pre">z,</span> <span class="pre">shared_exponent=True)</span></code> to make fields <code class="docutils literal notranslate"><span class="pre">x,</span> <span class="pre">y,</span> <span class="pre">z</span></code> share a common
exponent.</p>
</section>
<section id="your-first-program">
<h4>Your first program<a class="headerlink" href="#your-first-program" title="Link to this heading">#</a></h4>
<p>You probably cannot wait to write your first Taichi program with quantized data
types. The easiest way is to modify the data definitions of an existing example.
Assume you want to save memory for
<a class="reference external" href="https://github.com/taichi-dev/taichi/blob/master/python/taichi/examples/simulation/euler.py">examples/simulation/euler.py</a>.
Because most data definitions in the example are similar, here only field <code class="docutils literal notranslate"><span class="pre">Q</span></code> is
used for illustration:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">Q</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">Vector</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ti</span><span class="o">.</span><span class="n">f32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>
</pre></div>
</div>
<p>An element of <code class="docutils literal notranslate"><span class="pre">Q</span></code> now occupies 4 x 32 = 128 bits. If you can fit it in
64 bits, then the memory usage is halved. A direct and first attempt is to
use quantized floating-point numbers with a shared exponent:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">float_type_c</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">quant</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">exp</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">frac</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">Q_old</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">Vector</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float_type_c</span><span class="p">)</span>
<span class="n">bitpack</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">BitpackedFields</span><span class="p">(</span><span class="n">max_num_bits</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
<span class="n">bitpack</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">Q_old</span><span class="p">,</span> <span class="n">shared_exponent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ti</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">dense</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">ij</span><span class="p">,</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">bitpack</span><span class="p">)</span>
</pre></div>
</div>
<p>Surprisingly, you find that there is no obvious difference in visual effects
after the change, and you now successfully finish a Taichi program with
quantized data types! More attempts are left to you.</p>
</section>
<section id="more-complicated-quantization-schemes">
<h4>More complicated quantization schemes<a class="headerlink" href="#more-complicated-quantization-schemes" title="Link to this heading">#</a></h4>
<p>Here comes a more complicated scenario. In a 3D Eulerian fluid simulation, a
voxel may need to store a 3D vector for velocity, and an integer value for cell
category with three possible values: “source”, “Dirichlet boundary”, and
“Neumann boundar”. You can actually store all information with a single 32-bit
<code class="docutils literal notranslate"><span class="pre">ti.BitpackedFields</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">velocity_component_type</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">quant</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">exp</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">frac</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">compute</span><span class="o">=</span><span class="n">ti</span><span class="o">.</span><span class="n">f32</span><span class="p">)</span>
<span class="n">velocity</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">Vector</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">velocity_component_type</span><span class="p">)</span>

<span class="c1"># Since there are only three cell categories, 2 bits are enough.</span>
<span class="n">cell_category_type</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">quant</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="n">bits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">signed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compute</span><span class="o">=</span><span class="n">ti</span><span class="o">.</span><span class="n">i32</span><span class="p">)</span>
<span class="n">cell_category</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">cell_category_type</span><span class="p">)</span>

<span class="n">voxel</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">BitpackedFields</span><span class="p">(</span><span class="n">max_num_bits</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<span class="c1"># Place three components of velocity into the voxel, and let them share the exponent.</span>
<span class="n">voxel</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">velocity</span><span class="p">,</span> <span class="n">shared_exponent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Place the 2-bit cell category.</span>
<span class="n">voxel</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">cell_category</span><span class="p">)</span>
<span class="c1"># Create 512 x 512 x 256 voxels.</span>
<span class="n">ti</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">dense</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">ijk</span><span class="p">,</span> <span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">256</span><span class="p">))</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">voxel</span><span class="p">)</span>
</pre></div>
</div>
<p>The compression scheme above allows you to store 13 bytes (4B x 3 + 1B) into
just 4 bytes. Note that you can still use velocity and cell_category in the
computation code, as if they are <code class="docutils literal notranslate"><span class="pre">ti.f32</span></code> and <code class="docutils literal notranslate"><span class="pre">ti.u8</span></code>.</p>
<p><img alt="image" src="../../_images/bitpacked_fields_layout_example.png" /></p>
</section>
</section>
<section id="quant-arrays">
<h3>Quant arrays<a class="headerlink" href="#quant-arrays" title="Link to this heading">#</a></h3>
<p>Bitpacked fields are actually laid in an array of structure (AOS) order.
However, there are also cases where a single quantized type is required to get
laid in an array. For example, you may want to store 8 x u4 values in a single
u32 type, to represent bin values of a histogram:</p>
<p><img alt="image" src="../../_images/quant_array_layout_example.png" /></p>
<p>Quant array is exactly what you need. A <code class="docutils literal notranslate"><span class="pre">quant_array</span></code> is a SNode which
can reinterpret a primitive type into an array of a quantized type:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">bin_value_type</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">quant</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="n">bits</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">signed</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># The quant array for 512 x 512 bin values</span>
<span class="n">array</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">dense</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">ij</span><span class="p">,</span> <span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="mi">64</span><span class="p">))</span><span class="o">.</span><span class="n">quant_array</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">j</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">max_num_bits</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<span class="c1"># Place the unsigned 4-bit bin value into the array</span>
<span class="n">array</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">bin_value_type</span><span class="p">)</span>
</pre></div>
</div>
<div class="note docutils">
<ol class="arabic simple">
<li><p>Only one field can be placed under a <code class="docutils literal notranslate"><span class="pre">quant_array</span></code>.</p></li>
<li><p>Only quantized integer types and quantized fixed-point types are supported as
the <code class="docutils literal notranslate"><span class="pre">dtype</span></code> of the field under a <code class="docutils literal notranslate"><span class="pre">quant_array</span></code>.</p></li>
<li><p>The size of the <code class="docutils literal notranslate"><span class="pre">dtype</span></code> of the field times the shape of the <code class="docutils literal notranslate"><span class="pre">quant_array</span></code>
must be less than or equal to the <code class="docutils literal notranslate"><span class="pre">max_num_bits</span></code> of the <code class="docutils literal notranslate"><span class="pre">quant_array</span></code>.</p></li>
</ol>
</div>
<section id="bit-vectorization">
<h4>Bit vectorization<a class="headerlink" href="#bit-vectorization" title="Link to this heading">#</a></h4>
<p>For quant arrays of 1-bit quantized integer types (“boolean”), Taichi provides
an additional optimization - bit vectorization. It aims at vectorizing
operations on such quant arrays under struct fors:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">u1</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">quant</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">512</span>
<span class="n">M</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">u1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">u1</span><span class="p">)</span>
<span class="n">ti</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">dense</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">i</span><span class="p">,</span> <span class="n">N</span> <span class="o">//</span> <span class="n">M</span><span class="p">)</span><span class="o">.</span><span class="n">quant_array</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">i</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">max_num_bits</span><span class="o">=</span><span class="n">M</span><span class="p">)</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">ti</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">dense</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">i</span><span class="p">,</span> <span class="n">N</span> <span class="o">//</span> <span class="n">M</span><span class="p">)</span><span class="o">.</span><span class="n">quant_array</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">i</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">max_num_bits</span><span class="o">=</span><span class="n">M</span><span class="p">)</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="nd">@ti</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">assign_vectorized</span><span class="p">():</span>
    <span class="n">ti</span><span class="o">.</span><span class="n">loop_config</span><span class="p">(</span><span class="n">bit_vectorize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
        <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>  <span class="c1"># 32 bits are handled at a time</span>

<span class="n">assign_vectorized</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="reference-examples">
<h2>Reference examples<a class="headerlink" href="#reference-examples" title="Link to this heading">#</a></h2>
<p>The following examples are from the
<a class="reference external" href="https://yuanming.taichi.graphics/publication/2021-quantaichi/quantaichi.pdf">QuanTaichi paper</a>,
so you can dig into details there.</p>
<section id="game-of-life">
<h3><a class="reference external" href="https://github.com/taichi-dev/quantaichi/tree/main/gol">Game of Life</a><a class="headerlink" href="#game-of-life" title="Link to this heading">#</a></h3>
<p><img alt="image" src="https://github.com/taichi-dev/quantaichi/raw/main/pics/teaser_gol.jpg" /></p>
</section>
<section id="eulerian-fluid">
<h3><a class="reference external" href="https://github.com/taichi-dev/quantaichi/tree/main/eulerian_fluid">Eulerian Fluid</a><a class="headerlink" href="#eulerian-fluid" title="Link to this heading">#</a></h3>
<p><img alt="image" src="https://github.com/taichi-dev/quantaichi/raw/main/pics/smoke_result.png" /></p>
</section>
<section id="mls-mpm">
<h3><a class="reference external" href="https://github.com/taichi-dev/taichi_elements/blob/master/demo/demo_quantized_simulation_letters.py">MLS-MPM</a><a class="headerlink" href="#mls-mpm" title="Link to this heading">#</a></h3>
<p><img alt="image" src="https://github.com/taichi-dev/quantaichi/raw/main/pics/mpm-235.jpg" /></p>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="meta.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Metaprogramming</p>
      </div>
    </a>
    <a class="right-next"
       href="../differentiable/differentiable_programming.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Differentiable Programming</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quantized-data-types">Quantized data types</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#quantized-integers">Quantized integers</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#quantized-fixed-point-numbers">Quantized fixed-point numbers</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#quantized-floating-point-numbers">Quantized floating-point numbers</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-types">Compute types</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-containers-for-quantized-data-types">Data containers for quantized data types</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bitpacked-fields">Bitpacked fields</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shared-exponent">Shared exponent</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#your-first-program">Your first program</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#more-complicated-quantization-schemes">More complicated quantization schemes</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#quant-arrays">Quant arrays</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bit-vectorization">Bit vectorization</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reference-examples">Reference examples</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#game-of-life">Game of Life</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#eulerian-fluid">Eulerian Fluid</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mls-mpm">MLS-MPM</a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/user_guide/advanced/quant.md.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2023 Taichi Graphics Inc; 2025 Genesis AI Inc.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>